{{!-- The big email subscribe modal content --}}
{{#if @labs.members}}
<div class="subscribe-success-message">
  <a class="subscribe-close" href="javascript:;"></a>
  You've successfully subscribed to {{@site.title}}!
</div>

<div id="subscribe" class="subscribe-overlay">
  <a class="subscribe-close" href="#"></a>
  <div class="subscribe-overlay-content">
    {{#if @site.logo}}
    <img class="subscribe-overlay-logo" src="{{@site.logo}}" alt="{{@site.title}}" />
    {{/if}}
    <div class="subscribe-form">
      <h1 class="subscribe-overlay-title">Subscribe to {{@site.title}}</h1>
      <p class="subscribe-overlay-description">Stay up to date! Get all the latest & greatest posts delivered straight
        to your inbox</p>
      <form data-members-form="subscribe">
        <div class="form-group">
          <input class="subscribe-email" data-members-email placeholder="youremail@example.com" autocomplete="false" />
          <button class="button primary" type="submit">
            <span class="button-content">Subscribe</span>
            <span class="button-loader">{{> "icons/loader"}}</span>
          </button>
        </div>
        <div class="message-success">
          <strong>Great!</strong> Check your inbox and click the link to confirm your subscription.
        </div>
        <div class="message-error">
          Please enter a valid email address!
        </div>
      </form>
    </div>
  </div>
</div>
{{/if}}


{{!-- Scripts for Members subscription --}}
<script>
  // Parse the URL parameter
  function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[\[\]]/g, "\\$&");
    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
      results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, " "));
  }

  // Give the parameter a variable name
  var action = getParameterByName('action');

  $(document).ready(function () {
    if (action == 'subscribe') {
      $('body').addClass("subscribe-success");
    }

    $('.subscribe-success-message .subscribe-close').click(function () {
      $('.subscribe-success-message').addClass('close');
    });

    // Reset form on opening subscrion overlay
    $('.subscribe-button').click(function () {
      $('.subscribe-overlay form').removeClass();
      $('.subscribe-email').val('');
    });
  });
</script>